{
  "testCases": [
    {
      "name": "updateStatus with valid parameters and passing constraints",
      "setup": {
        "createInstance": {
          "entity": "Order",
          "data": {
            "id": "order1",
            "customerId": "customer1",
            "status": "pending",
            "amount": 150
          }
        }
      },
      "command": {
        "name": "updateStatus",
        "entityName": "Order",
        "instanceId": "order1",
        "input": {
          "newStatus": "processing"
        }
      },
      "expectedResult": {
        "success": true,
        "emittedEvents": [
          {
            "name": "OrderStatusUpdated",
            "channel": "order.status.updated",
            "timestamp": 1000000000000
          }
        ]
      }
    },
    {
      "name": "updateStatus with warn constraint (passed)",
      "setup": {
        "createInstance": {
          "entity": "Order",
          "data": {
            "id": "order2",
            "customerId": "customer2",
            "status": "pending",
            "amount": 50
          }
        }
      },
      "command": {
        "name": "updateStatus",
        "entityName": "Order",
        "instanceId": "order2",
        "input": {
          "newStatus": "processing"
        }
      },
      "expectedResult": {
        "success": true,
        "emittedEvents": [
          {
            "name": "OrderStatusUpdated",
            "channel": "order.status.updated",
            "timestamp": 1000000000000
          }
        ]
      }
    },
    {
      "name": "cancel command with warn constraint (passed)",
      "setup": {
        "createInstance": {
          "entity": "Order",
          "data": {
            "id": "order3",
            "customerId": "customer3",
            "status": "pending",
            "amount": 75
          }
        }
      },
      "command": {
        "name": "cancel",
        "entityName": "Order",
        "instanceId": "order3",
        "input": {}
      },
      "expectedResult": {
        "success": true,
        "emittedEvents": [
          {
            "name": "OrderCancelled",
            "channel": "order.cancelled",
            "timestamp": 1000000000000
          }
        ]
      }
    },
    {
      "name": "updateStatus with block constraint (status change prevented)",
      "setup": {
        "createInstance": {
          "entity": "Order",
          "data": {
            "id": "order4",
            "customerId": "customer4",
            "status": "cancelled",
            "amount": 200
          }
        }
      },
      "command": {
        "name": "updateStatus",
        "entityName": "Order",
        "instanceId": "order4",
        "input": {
          "newStatus": "shipped"
        }
      },
      "expectedResult": {
        "success": false,
        "error": "Cannot update cancelled order",
        "emittedEvents": []
      }
    },
    {
      "name": "cancel command with block constraint (prevented)",
      "setup": {
        "createInstance": {
          "entity": "Order",
          "data": {
            "id": "order5",
            "customerId": "customer5",
            "status": "shipped",
            "amount": 100
          }
        }
      },
      "command": {
        "name": "cancel",
        "entityName": "Order",
        "instanceId": "order5",
        "input": {}
      },
      "expectedResult": {
        "success": false,
        "error": "Cannot cancel shipped order",
        "emittedEvents": []
      }
    },
    {
      "name": "entity constraints with block constraint (prevented)",
      "entity": "Order",
      "data": {
        "id": "order6",
        "customerId": "customer6",
        "status": "invalid",
        "amount": -50
      },
      "expectedConstraintFailures": [
        {
          "constraintName": "positiveAmount",
          "expression": "self.amount >= 0",
          "severity": "block"
        },
        {
          "constraintName": "validStatus",
          "expression": "self.status in [\"pending\", \"processing\", \"shipped\", \"delivered\", \"cancelled\"]",
          "severity": "block"
        }
      ]
    },
    {
      "name": "entity constraints with warn constraint (passed)",
      "entity": "Order",
      "data": {
        "id": "order7",
        "customerId": "customer7",
        "status": "pending",
        "amount": 80
      },
      "expectedConstraintFailures": []
    }
  ]
}
